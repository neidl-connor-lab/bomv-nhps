========================JOB INFO=========================
Job ID: 812316
Job name: genomics-sample18
Start date: Thu Aug  1 11:08:44 CDT 2024
Current directory: /scratch/09961/jaturcin/work/cyno-bomv
=========================================================

[MSG] STEP 0: CHECKING INPUTS
[MSG] Host index: pipeline/mfascicularis-v6.0/mfascicularis-v6.0
[MSG] Host index: pipeline/bomv-MF319186.1/bomv-MF319186.1
[MSG] Reference FASTA: pipeline/bomv-MF319186.1.fa
[MSG] First FASTQ file: data/fastq/sample18-r1.fq.gz
[MSG] Second FASTQ file: data/fastq/sample18-r2.fq.gz
[MSG] Valid output directory: data/genomics
[MSG] Working with sample: sample18
[MSG] Done checking inputs!

[MSG] STEP 1: DISCARD HOST READS
[MSG] CMD: bowtie2 --threads 8 --quiet -x 'pipeline/mfascicularis-v6.0/mfascicularis-v6.0' --un-conc-gz 'data/genomics/sample18/filtered-r%.fq.gz' -1 'data/fastq/sample18-r1.fq.gz' -2 'data/fastq/sample18-r2.fq.gz' > /dev/null
WARNING: Skipping mount /var/apptainer/mnt/session/etc/resolv.conf [files]: /etc/resolv.conf doesn't exist in container
[MSG] Host alignment succeeded
[MSG] STEP 2: METAGENOMIC CLASSIFICATION
[MSG] CMD: kraken2 --threads 8 --db 'pipeline/kraken2db' --output - --report 'data/genomics/sample18/metagenomics.tsv' --use-names --gzip-compressed --paired 'data/genomics/sample18/filtered-r1.fq.gz' 'data/genomics/sample18/filtered-r2.fq.gz'
WARNING: Skipping mount /var/apptainer/mnt/session/etc/resolv.conf [files]: /etc/resolv.conf doesn't exist in container
Loading database information... done.
10710893 sequences (1606.63 Mbp) processed in 36.572s (17572.5 Kseq/m, 2635.88 Mbp/m).
  7636754 sequences classified (71.30%)
  3074139 sequences unclassified (28.70%)
[MSG] Metagenomic classification succeeded

[MSG] STEP 3: ALIGN TO VIRUS
[MSG] CMD: bowtie2 --threads 8 -x 'pipeline/bomv-MF319186.1/bomv-MF319186.1' -1 'data/genomics/sample18/filtered-r1.fq.gz' -2 'data/genomics/sample18/filtered-r2.fq.gz' > 'data/genomics/sample18/alignment.sam'
WARNING: Skipping mount /var/apptainer/mnt/session/etc/resolv.conf [files]: /etc/resolv.conf doesn't exist in container
10710893 reads; of these:
  10710893 (100.00%) were paired; of these:
    10662923 (99.55%) aligned concordantly 0 times
    47970 (0.45%) aligned concordantly exactly 1 time
    0 (0.00%) aligned concordantly >1 times
    ----
    10662923 pairs aligned concordantly 0 times; of these:
      490 (0.00%) aligned discordantly 1 time
    ----
    10662433 pairs aligned 0 times concordantly or discordantly; of these:
      21324866 mates make up the pairs; of these:
        21323283 (99.99%) aligned 0 times
        1583 (0.01%) aligned exactly 1 time
        0 (0.00%) aligned >1 times
0.46% overall alignment rate
[MSG] Viral alignment succeeded
samtools idxstats: file is not position sorted
samtools idxstats: failed to process "data/genomics/sample18/alignment.sam"
/var/spool/slurmd/job812316/slurm_script: line 248: [: -eq: unary operator expected
[MSG] CMD: samtools view --threads 8 -b -h 'data/genomics/sample18/alignment.sam' > 'data/genomics/sample18/alignment-raw.bam'
[MSG] Compression succeeded

[MSG] STEP 4: PROCESS ALIGNMENT
[MSG] CMD: samtools sort --threads 8 'data/genomics/sample18/alignment-raw.bam' > 'data/genomics/sample18/alignment-sorted.bam'
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[MSG] Sorting succeeded
[MSG] CMD: lofreq indelqual --dindel --ref 'pipeline/bomv-MF319186.1.fa' 'data/genomics/sample18/alignment-sorted.bam' > 'data/genomics/sample18/alignment.bam'
WARNING: Skipping mount /var/apptainer/mnt/session/etc/resolv.conf [files]: /etc/resolv.conf doesn't exist in container
[MSG] Indelqual succeeded
[MSG] CMD: samtools index 'data/genomics/sample18/alignment.bam'
[MSG] Indexing succeeded

[MSG] STEP 5: CALCULATE COVERAGE
[MSG] CMD: samtools depth --threads 8 -a -H 'data/genomics/sample18/alignment.bam' > 'data/genomics/sample18/coverage.tsv'
[MSG] Coverage succeeded

[MSG] STEP 6: ASSEMBLE CONSENSUS
[MSG] CMD: samtools consensus --threads 8 -a --use-qual --min-depth 100 --call-fract 0.5 --mode simple  --output 'data/genomics/sample18/consensus-tmp.fa' 'data/genomics/sample18/alignment.bam'
[MSG] Consensus succeeded
[MSG] Updating consensus header

[MSG] STEP 7: QUANTIFY SNVs
[MSG] CMD: lofreq call-parallel --pp-threads 8 --call-indels --min-cov 100 --ref 'pipeline/bomv-MF319186.1.fa' 'data/genomics/sample18/alignment.bam' > 'data/genomics/sample18/snvs.vcf'
WARNING: Skipping mount /var/apptainer/mnt/session/etc/resolv.conf [files]: /etc/resolv.conf doesn't exist in container
INFO [2024-08-01 11:53:50,768]: Using 8 threads with following basic args: lofreq call --call-indels --min-cov 100 --ref pipeline/bomv-MF319186.1.fa data/genomics/sample18/alignment.bam

INFO [2024-08-01 11:53:50,776]: Adding 19 commands to mp-pool
Number of substitution tests performed: 44490
Number of indel tests performed: 617
INFO [2024-08-01 11:53:53,311]: Executing lofreq filter -i /tmp/lofreq2_call_parallel7j6i3aub/concat.vcf.gz -o - --snvqual-thresh 66 --indelqual-thresh 48

[MSG] LoFreq succeeded

[MSG] Pipeline complete! Printing package versions...

Currently Loaded Modules:
  1) intel/24.0             7) biocontainers/0.1.0
  2) impi/21.11             8) bowtie2/ctr-2.3.4.3--py37he860b03_1
  3) autotools/1.4          9) samtools/ctr-1.20--h50ea8bc_0
  4) cmake/3.28.1          10) kraken2/ctr-2.0.7_beta--pl526h2d50403_0
  5) TACC                  11) lofreq/ctr-2.1.3.1--py36_0
  6) tacc-apptainer/1.2.5

 

[MSG] JOB COMPLETE!

